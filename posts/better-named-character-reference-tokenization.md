<p><aside class="note">

Note: I am not a 'browser engine' person, nor a 'data structures' person; this corner of the major browsers just hasn't received any attention for a *very* long time. It's almost certain that an even better implementation than what I came up with is very possible.

</aside></p>

A while back, for <span style="border-bottom: 1px dotted; cursor: default;" title="the actual reason will be detailed later">no real reason*</span>, I tried writing an implementation of a data structure tailored to the specific use case of [the *Named character reference state*](https://html.spec.whatwg.org/multipage/parsing.html#named-character-reference-state) of HTML tokenization (here's the [link to that experiment](https://github.com/squeek502/named-character-references)). Recently, I took that implementation, ported it to C++, and [used it to make some efficiency gains and fix some spec compliance issues](https://github.com/LadybirdBrowser/ladybird/pull/3011) in the [Ladybird browser](https://ladybird.org/).

Throughout this, I never actually looked at the implementations used in any of the major browser engines. However, now that I *have* looked at Blink/WebKit/Gecko, I've realized that my implementation seems to be either on-par or better across the metrics that the browser engines care about:

- Efficiency (just as fast, if not *slightly* faster)
- Compactness of the data (uses ~60% of the data size)
- Ease of use

<p><aside class="note">

Note: I'm singling out these metrics because, in [the python script](https://github.com/chromium/chromium/blob/8469b0ca44e36be251999cc819ff96dc3ac43290/third_party/blink/renderer/build/scripts/make_html_entity_table.py#L29-L32) that generates the data structures used for named character reference tokenization in Blink (the browser engine of Chromium), it contains this docstring (emphasis mine):

<pre><code class="language-python"><span class="token_string">"""This python script creates the raw data that is our entity
database. The representation is one string database containing all
strings we could need, and then a mapping from offset+length -> entity
data.</span> <b>That is compact, easy to use and efficient.</b><span class="token_string">"""</span>
</code></pre>

</aside></p>

So, I thought I'd take you through what I came up with and how it compares to the implementations in the major browser engines. Mostly, though, I just think the data structure I used is neat and want to tell you about it (fair warning: it's not novel).

## What is a named character reference?

A named character reference is an HTML entity specified using an ampersand (`&`) followed by an ASCII alphanumeric name. An ordained set of names will get transformed during HTML parsing into particular code point(s). For example, `&bigcirc;` is a valid named character reference that gets transformed into the symbol &bigcirc;, while `&amp;` will get transformed into &amp;.

<p><aside class="note">

Note: The &bigcirc; symbol is the Unicode code point `U+25EF`, which means it could also be specified as a *numeric* character reference using either `&#x25EF;` or `&#9711;`. We're only focusing on *named* character references, though.

</aside></p>

Here's a few properties of named character references that are relevant for what we'll ultimately be aiming to implement:

- Always starts with `&`
- Only contains characters in the ASCII range
- Case-sensitive
- Usually, but not always, ends with `;`
- Are transformed into either 1 or 2 code points
  + Mostly irrelevant side note: those code point(s) usually make up one [grapheme](https://www.unicode.org/glossary/#grapheme) (i.e. most second code points are combining code points), but not always (e.g. `&fjlig;` maps to `U+0066 U+006A` which are just the ASCII letters `fj`)

Most crucially, though, the mappings of named characters references are *fixed*. The [HTML standard](https://html.spec.whatwg.org/multipage/named-characters.html#named-character-references) contains this note about named character references:

> **Note:** This list is static and [will not be expanded or changed in the future](https://github.com/whatwg/html/blob/main/FAQ.md#html-should-add-more-named-character-references).

This means that it's now safe to represent the data in the minimum amount of bits possible without any fear of needing to accommodate more named character reference mappings in the future.

<p><aside class="note">

Note: This is a big part of why I think better solutions than mine should be very possible. I feel like I've only scratched the surface in terms of a purpose-built data structure for this particular task.

</aside></p>

## Named character reference tokenization overview

I'm specifically going to be talking about the [*Named character reference state* of HTML tokenization](https://html.spec.whatwg.org/multipage/parsing.html#named-character-reference-state). You can read the spec for it if you want (it's fairly short) but there's really only one sentence we're interested in:

> Consume the maximum number of characters possible, where the consumed characters are one of the identifiers in the first column of the named character references table.

This sentence is really the crux of the implementation, but the spec is quite hand-wavy here and conceals a lot of complexity. The example given a bit later in the spec hints at why the above sentence is not so straightforward (edited to exclude irrelevant details; for context, <code><span class="token_keyword">&amp;not</span></code> is a valid named character reference, as is <code><span class="token_keyword">&amp;notin;</span></code>):

> **Example:** If the markup contains the string <code>I'm <span class="token_keyword">&amp;not</span>it; I tell you</code>, the character reference is parsed as "not", as in, `I'm ¬it; I tell you`. But if the markup was <code>I'm <span class="token_keyword">&amp;notin;</span> I tell you</code>, the character reference would be parsed as "notin;", resulting in `I'm ∉ I tell you`.

That is, with `&notit;`, the characters up to and including `&noti` can still lead to a valid named character reference (`&notin;`, among others), so we only know that `&notit;` is invalid once we've reached `&notit` which can no longer lead to a valid named character reference. What this means is that there needs to be some amount of backtracking involved, as the goal is to consume only the characters that are part of the longest matching named character reference.

That's not all, though...

### The spectre of `document.write`

HTML markup is *mutable while it is being tokenized*, meaning looking ahead is not always reliable/possible since what's there now might be different by the time you actually get there.


```html
<script>
document.write("&not");
</script>in;
```

The expected result is &notin;, meaning the resolved character reference is `&notin;`.

After the closing script tag is tokenized, the script is replaced with an insertion point. Right before the script is executed, the tokenizer input can be visualized as (where <code><span class="token_string" style="outline: 2px dotted black; padding: 1px; margin: 4px;"></span></code> is the insertion point):

<pre><code class="language-html"><span class="token_string" style="outline: 2px dotted black; padding: 1px; margin: 4px;"></span><span class="token_identifer">in;</span></code></pre>

And after the `<script>` and therefore the `document.write` call runs:

<pre><code class="language-html"><span class="token_string" style="outline: 2px dotted black; padding: 1px; margin: 4px;">&amp;not</span><span class="token_identifer">in;</span></code></pre>

The ordering of the insertion matters. For example, this does not result in <code>&notin;</code>, but instead <code>&not;in;</code>:

```html
&not<script>
document.write("in;");
</script>
```

```html
<script>
for (let char of "&not") {
  document.write(char);
}
</script>in;
```

<pre><code class="language-html"><span class="token_string" style="outline: 2px dotted black; padding: 1px; margin: 4px;" id="not-insertion-point"></span><span class="token_identifer">in;</span></code></pre>

<script>
(function() {
	let i=0;
	let letters = '&not';
	let e = document.querySelector('#not-insertion-point');
	setInterval(function() {
		e.textContent = letters.substring(0,i);
		// + 3 to linger on the final result for a bit
		i = (i + 1) % (letters.length + 3);
	}, 500);
})();
</script>

TODO: Proper explanation of why tokenization has to run while the script is being executed, i.e. you can't just resolve all script tags upfront and then tokenize the immutable result.

Consider this nightmare of an example:

```html
<script>
for (let char of "<script>document.write('&not');<\/script>") {
  document.write(char);
}
</script>in;
```

## Trie implementation

A data structure that seems pretty good for this sort of thing is a [trie](https://en.wikipedia.org/wiki/Trie). A trie is a specialized tree where each node contains a character that can come after the character of its parent node in a set of words. Below is a representation of a trie containing this small subset of named character references:

- `&not` &rarr; &not; (note the lack of a semicolon at the end, this variant was chosen to make the example easier to understand)
- `&notinva;` &rarr; &notinva;
- `&notinvb;` &rarr; &notinvb;
- `&notinvc;` &rarr; &notinvc;
- `&notniva;` &rarr; &notniva;
- `&notnivb;` &rarr; &notnivb;
- `&notnivc;` &rarr; &notnivc;

<p><aside class="note">

- The `&` is excluded from the trie since it's the first character of *every* named character reference.
- The nodes with a red outline are those marked as the end of a word in the set.

</aside></p>

<div style="text-align: center;">
<svg id="mermaid-trie" width="100%" xmlns="http://www.w3.org/2000/svg" class="mermaid-flowchart flowchart" style="max-width: 289.9666748046875px;" viewBox="0 0 289.9666748046875 438" role="graphics-document document" aria-roledescription="flowchart-v2"><g><marker id="mermaid-123_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M145.725,38.5L145.642,39.25C145.558,40,145.392,41.5,145.308,43.083C145.225,44.667,145.225,46.333,145.225,47.167L145.225,48" id="L_root_n_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M145.225,87L145.225,87.833C145.225,88.667,145.225,90.333,145.225,92C145.225,93.667,145.225,95.333,145.225,96.167L145.225,97" id="L_n_letter_o_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M145.225,136L145.225,136.833C145.225,137.667,145.225,139.333,145.225,141C145.225,142.667,145.225,144.333,145.225,145.167L145.225,146" id="L_letter_o_t_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M129.675,170.774L120.226,173.978C110.778,177.182,91.881,183.591,82.432,187.629C72.983,191.667,72.983,193.333,72.983,194.167L72.983,195" id="L_t_i1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M160.775,170.774L170.224,173.978C179.672,177.182,198.569,183.591,208.018,187.629C217.467,191.667,217.467,193.333,217.467,194.167L217.467,195" id="L_t_n1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,234L72.983,234.833C72.983,235.667,72.983,237.333,72.983,239C72.983,240.667,72.983,242.333,72.983,243.167L72.983,244" id="L_i1_n2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,234L217.467,234.833C217.467,235.667,217.467,237.333,217.467,239C217.467,240.667,217.467,242.333,217.467,243.167L217.467,244" id="L_n1_i2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,283L217.467,283.833C217.467,284.667,217.467,286.333,217.467,288C217.467,289.667,217.467,291.333,217.467,292.167L217.467,293" id="L_i2_v1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,283L72.983,283.833C72.983,284.667,72.983,286.333,72.983,288C72.983,289.667,72.983,291.333,72.983,292.167L72.983,293" id="L_n2_v2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M201.175,320.745L195.822,323.454C190.469,326.164,179.764,331.582,174.411,335.124C169.058,338.667,169.058,340.333,169.058,341.167L169.058,342" id="L_v1_a1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,332L217.467,332.833C217.467,333.667,217.467,335.333,217.467,337C217.467,338.667,217.467,340.333,217.467,341.167L217.467,342" id="L_v1_b1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M233.758,320.787L239.071,323.489C244.383,326.191,255.008,331.596,260.321,335.131C265.633,338.667,265.633,340.333,265.633,341.167L265.633,342" id="L_v1_c1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M56.692,320.745L51.339,323.454C45.986,326.164,35.281,331.582,29.928,335.124C24.575,338.667,24.575,340.333,24.575,341.167L24.575,342" id="L_v2_a2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,332L72.983,332.833C72.983,333.667,72.983,335.333,72.983,337C72.983,338.667,72.983,340.333,72.983,341.167L72.983,342" id="L_v2_b2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M89.275,320.787L94.587,323.489C99.9,326.191,110.525,331.596,115.838,335.131C121.15,338.667,121.15,340.333,121.15,341.167L121.15,342" id="L_v2_c2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M169.058,381L169.058,381.833C169.058,382.667,169.058,384.333,169.058,386C169.058,387.667,169.058,389.333,169.058,390.167L169.058,391" id="L_a1_semi1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,381L217.467,381.833C217.467,382.667,217.467,384.333,217.467,386C217.467,387.667,217.467,389.333,217.467,390.167L217.467,391" id="L_b1_semi2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M265.633,381L265.633,381.833C265.633,382.667,265.633,384.333,265.633,386C265.633,387.667,265.633,389.333,265.633,390.167L265.633,391" id="L_c1_semi3_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M24.575,381L24.575,381.833C24.575,382.667,24.575,384.333,24.575,386C24.575,387.667,24.575,389.333,24.575,390.167L24.575,391" id="L_a2_semi4_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,381L72.983,381.833C72.983,382.667,72.983,384.333,72.983,386C72.983,387.667,72.983,389.333,72.983,390.167L72.983,391" id="L_b2_semi5_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.15,381L121.15,381.833C121.15,382.667,121.15,384.333,121.15,386C121.15,387.667,121.15,389.333,121.15,390.167L121.15,391" id="L_c2_semi6_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-root-0" transform="translate(145.2249984741211, 23)"><polygon points="15,0 30,-15 15,-30 0,-15" class="label-container" transform="translate(-15,15)"></polygon><g class="label" style="" transform="translate(0, 0)"><rect></rect><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n-1" transform="translate(145.2249984741211, 67.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-letter_o-3" transform="translate(145.2249984741211, 116.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.666664123535156" y="-19.5" width="33.33332824707031" height="39"></rect><g class="label" style="" transform="translate(-4.291664123535156, -12)"><rect></rect><foreignObject width="8.583328247070312" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>o</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-t-5" transform="translate(145.2249984741211, 165.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.550003051757812" y="-19.5" width="31.100006103515625" height="39"></rect><g class="label" style="" transform="translate(-3.1750030517578125, -12)"><rect></rect><foreignObject width="6.350006103515625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>t</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i1-7" transform="translate(72.98332977294922, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n1-8" transform="translate(217.46666717529297, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n2-10" transform="translate(72.98332977294922, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i2-12" transform="translate(217.46666717529297, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-v1-14" transform="translate(217.46666717529297, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>v</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-v2-16" transform="translate(72.98332977294922, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>v</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a1-18" transform="translate(169.05833435058594, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>a</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b1-19" transform="translate(217.46666717529297, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>b</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-c1-20" transform="translate(265.63333892822266, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>c</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a2-22" transform="translate(24.574996948242188, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>a</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b2-23" transform="translate(72.98332977294922, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>b</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-c2-24" transform="translate(121.1500015258789, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>c</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi1-26" transform="translate(169.05833435058594, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi2-28" transform="translate(217.46666717529297, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi3-30" transform="translate(265.63333892822266, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi4-32" transform="translate(24.574996948242188, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi5-34" transform="translate(72.98332977294922, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi6-36" transform="translate(121.1500015258789, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g></g></g></g></svg>
</div>

`&notinvc;` path:

<div style="text-align: center;">
<svg id="mermaid-trie-with-value" width="100%" xmlns="http://www.w3.org/2000/svg" class="mermaid-flowchart flowchart" style="max-width: 289.9666748046875px;" viewBox="0 0 289.9666748046875 500" role="graphics-document document" aria-roledescription="flowchart-v2"><g><marker id="mermaid-123_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M145.725,38.5L145.642,39.25C145.558,40,145.392,41.5,145.308,43.083C145.225,44.667,145.225,46.333,145.225,47.167L145.225,48" id="L_root_n_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M145.225,87L145.225,87.833C145.225,88.667,145.225,90.333,145.225,92C145.225,93.667,145.225,95.333,145.225,96.167L145.225,97" id="L_n_letter_o_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M145.225,136L145.225,136.833C145.225,137.667,145.225,139.333,145.225,141C145.225,142.667,145.225,144.333,145.225,145.167L145.225,146" id="L_letter_o_t_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M129.675,170.774L120.226,173.978C110.778,177.182,91.881,183.591,82.432,187.629C72.983,191.667,72.983,193.333,72.983,194.167L72.983,195" id="L_t_i1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M160.775,170.774L170.224,173.978C179.672,177.182,198.569,183.591,208.018,187.629C217.467,191.667,217.467,193.333,217.467,194.167L217.467,195" id="L_t_n1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,234L72.983,234.833C72.983,235.667,72.983,237.333,72.983,239C72.983,240.667,72.983,242.333,72.983,243.167L72.983,244" id="L_i1_n2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,234L217.467,234.833C217.467,235.667,217.467,237.333,217.467,239C217.467,240.667,217.467,242.333,217.467,243.167L217.467,244" id="L_n1_i2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,283L217.467,283.833C217.467,284.667,217.467,286.333,217.467,288C217.467,289.667,217.467,291.333,217.467,292.167L217.467,293" id="L_i2_v1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,283L72.983,283.833C72.983,284.667,72.983,286.333,72.983,288C72.983,289.667,72.983,291.333,72.983,292.167L72.983,293" id="L_n2_v2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M201.175,320.745L195.822,323.454C190.469,326.164,179.764,331.582,174.411,335.124C169.058,338.667,169.058,340.333,169.058,341.167L169.058,342" id="L_v1_a1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,332L217.467,332.833C217.467,333.667,217.467,335.333,217.467,337C217.467,338.667,217.467,340.333,217.467,341.167L217.467,342" id="L_v1_b1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M233.758,320.787L239.071,323.489C244.383,326.191,255.008,331.596,260.321,335.131C265.633,338.667,265.633,340.333,265.633,341.167L265.633,342" id="L_v1_c1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M56.692,320.745L51.339,323.454C45.986,326.164,35.281,331.582,29.928,335.124C24.575,338.667,24.575,340.333,24.575,341.167L24.575,342" id="L_v2_a2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,332L72.983,332.833C72.983,333.667,72.983,335.333,72.983,337C72.983,338.667,72.983,340.333,72.983,341.167L72.983,342" id="L_v2_b2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M89.275,320.787L94.587,323.489C99.9,326.191,110.525,331.596,115.838,335.131C121.15,338.667,121.15,340.333,121.15,341.167L121.15,342" id="L_v2_c2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M169.058,381L169.058,381.833C169.058,382.667,169.058,384.333,169.058,386C169.058,387.667,169.058,389.333,169.058,390.167L169.058,391" id="L_a1_semi1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M217.467,381L217.467,381.833C217.467,382.667,217.467,384.333,217.467,386C217.467,387.667,217.467,389.333,217.467,390.167L217.467,391" id="L_b1_semi2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M265.633,381L265.633,381.833C265.633,382.667,265.633,384.333,265.633,386C265.633,387.667,265.633,389.333,265.633,390.167L265.633,391" id="L_c1_semi3_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M24.575,381L24.575,381.833C24.575,382.667,24.575,384.333,24.575,386C24.575,387.667,24.575,389.333,24.575,390.167L24.575,391" id="L_a2_semi4_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,381L72.983,381.833C72.983,382.667,72.983,384.333,72.983,386C72.983,387.667,72.983,389.333,72.983,390.167L72.983,391" id="L_b2_semi5_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.15,381L121.15,381.833C121.15,382.667,121.15,384.333,121.15,386C121.15,387.667,121.15,389.333,121.15,390.167L121.15,391" id="L_c2_semi6_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.008,420L121.008,451" id="L_semi3_notinvc_0" class=" edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-123_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-root-0" transform="translate(145.2249984741211, 23)"><polygon points="15,0 30,-15 15,-30 0,-15" class="label-container" transform="translate(-15,15)"></polygon><g class="label" style="" transform="translate(0, 0)"><rect></rect><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-n-1" transform="translate(145.2249984741211, 67.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-letter_o-3" transform="translate(145.2249984741211, 116.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.666664123535156" y="-19.5" width="33.33332824707031" height="39"></rect><g class="label" style="" transform="translate(-4.291664123535156, -12)"><rect></rect><foreignObject width="8.583328247070312" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>o</p></span></div></foreignObject></g></g><g class="node default selected-path end-of-word" id="flowchart-t-5" transform="translate(145.2249984741211, 165.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.550003051757812" y="-19.5" width="31.100006103515625" height="39"></rect><g class="label" style="" transform="translate(-3.1750030517578125, -12)"><rect></rect><foreignObject width="6.350006103515625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>t</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-i1-7" transform="translate(72.98332977294922, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n1-8" transform="translate(217.46666717529297, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-n2-10" transform="translate(72.98332977294922, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i2-12" transform="translate(217.46666717529297, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-v1-14" transform="translate(217.46666717529297, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>v</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-v2-16" transform="translate(72.98332977294922, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>v</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a1-18" transform="translate(169.05833435058594, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>a</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b1-19" transform="translate(217.46666717529297, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>b</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-c1-20" transform="translate(265.63333892822266, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>c</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a2-22" transform="translate(24.574996948242188, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>a</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b2-23" transform="translate(72.98332977294922, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>b</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-c2-24" transform="translate(121.1500015258789, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>c</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi1-26" transform="translate(169.05833435058594, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi2-28" transform="translate(217.46666717529297, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi3-30" transform="translate(265.63333892822266, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi4-32" transform="translate(24.574996948242188, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi5-34" transform="translate(72.98332977294922, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default selected-path end-of-word" id="flowchart-semi6-36" transform="translate(121.1500015258789, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default transformed-value" id="flowchart-notinvc-42" transform="translate(121.5083236694336, 475.2249984741211)"><g class="basic label-container" style=""><circle class="outer-circle" style="" r="18.224998474121094" cx="0" cy="0"></circle><circle class="inner-circle" style="" r="13.224998474121094" cx="0" cy="0"></circle></g><g class="label" style="" transform="translate(-5.724998474121094, -12)"><rect></rect><foreignObject width="11.449996948242188" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>&notinvc;</p></span></div></foreignObject></g></g></g></g></g></svg>
</div>

TODO: Stuff about representing a trie as an array

9854 nodes

2,231 named character references

This is trivial to use as a map to look up the associated code points that the named character reference should be transformed into.

Each node can only be the end of exactly one word (if it is an end-of-word node).

aka

No two words can share an end-of-word node.

aka

Each end of word is a distinct node, so we can either:
- Index into a value array using the same index as the end node (this potentially leaves you with a lot of unused gaps in the value array)
- Within each end-of-word node, store an index into value array (this makes the node size larger but the value array smaller)

## DAFSA implementation

<div style="text-align: center;">
<svg id="mermaid-dafsa" width="100%" xmlns="http://www.w3.org/2000/svg" class="mermaid-flowchart flowchart" style="max-width: 145.48333740234375px;" viewBox="0 0 145.48333740234375 438" role="graphics-document document" aria-roledescription="flowchart-v2"><g><marker id="mermaid-123_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M73.483,38.5L73.4,39.25C73.317,40,73.15,41.5,73.067,43.083C72.983,44.667,72.983,46.333,72.983,47.167L72.983,48" id="L_root_n_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,87L72.983,87.833C72.983,88.667,72.983,90.333,72.983,92C72.983,93.667,72.983,95.333,72.983,96.167L72.983,97" id="L_n_letter_o_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,136L72.983,136.833C72.983,137.667,72.983,139.333,72.983,141C72.983,142.667,72.983,144.333,72.983,145.167L72.983,146" id="L_letter_o_t_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M88.533,181.918L89.809,183.265C91.085,184.612,93.636,187.306,94.912,189.486C96.187,191.667,96.187,193.333,96.187,194.167L96.187,195" id="L_t_i1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M57.433,181.918L56.158,183.265C54.882,184.612,52.331,187.306,51.055,189.486C49.779,191.667,49.779,193.333,49.779,194.167L49.779,195" id="L_t_n1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,234L96.187,234.833C96.187,235.667,96.187,237.333,96.187,239C96.187,240.667,96.187,242.333,96.187,243.167L96.187,244" id="L_i1_n2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,234L49.779,234.833C49.779,235.667,49.779,237.333,49.779,239C49.779,240.667,49.779,242.333,49.779,243.167L49.779,244" id="L_n1_i2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,283L49.779,283.833C49.779,284.667,49.779,286.333,50.931,288.383C52.083,290.433,54.387,292.866,55.54,294.082L56.692,295.299" id="L_i2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,283L96.187,283.833C96.187,284.667,96.187,286.333,95.035,288.383C93.883,290.433,91.579,292.866,90.427,294.082L89.275,295.299" id="L_n2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M56.692,320.745L51.339,323.454C45.986,326.164,35.281,331.582,29.928,335.124C24.575,338.667,24.575,340.333,24.575,341.167L24.575,342" id="L_v_a_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,332L72.983,332.833C72.983,333.667,72.983,335.333,72.983,337C72.983,338.667,72.983,340.333,72.983,341.167L72.983,342" id="L_v_b_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M89.275,320.787L94.587,323.489C99.9,326.191,110.525,331.596,115.838,335.131C121.15,338.667,121.15,340.333,121.15,341.167L121.15,342" id="L_v_c_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M24.575,381L24.575,381.833C24.575,382.667,24.575,384.333,30.09,387.958C35.606,391.583,46.636,397.165,52.151,399.957L57.667,402.748" id="L_a_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,381L72.983,381.833C72.983,382.667,72.983,384.333,72.983,386C72.983,387.667,72.983,389.333,72.983,390.167L72.983,391" id="L_b_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.15,381L121.15,381.833C121.15,382.667,121.15,384.333,115.675,387.952C110.2,391.57,99.25,397.139,93.775,399.924L88.3,402.709" id="L_c_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-root-0" transform="translate(72.98332977294922, 23)"><polygon points="15,0 30,-15 15,-30 0,-15" class="label-container" transform="translate(-15,15)"></polygon><g class="label" style="" transform="translate(0, 0)"><rect></rect><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n-1" transform="translate(72.98332977294922, 67.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-letter_o-3" transform="translate(72.98332977294922, 116.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.666664123535156" y="-19.5" width="33.33332824707031" height="39"></rect><g class="label" style="" transform="translate(-4.291664123535156, -12)"><rect></rect><foreignObject width="8.583328247070312" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>o</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-t-5" transform="translate(72.98332977294922, 165.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.550003051757812" y="-19.5" width="31.100006103515625" height="39"></rect><g class="label" style="" transform="translate(-3.1750030517578125, -12)"><rect></rect><foreignObject width="6.350006103515625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>t</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i1-7" transform="translate(49.7791633605957, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n1-8" transform="translate(96.18749618530273, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n2-10" transform="translate(49.7791633605957, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i2-12" transform="translate(96.18749618530273, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-v-14" transform="translate(72.98332977294922, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>v</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a-18" transform="translate(24.574996948242188, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>a</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b-19" transform="translate(72.98332977294922, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>b</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-c-20" transform="translate(121.1500015258789, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>c</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi-22" transform="translate(72.98332977294922, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g></g></g></g></svg>
</div>

This takes the number of nodes down to 13 (compared to 22 for the trie).

The downside of this consolidation is that we lose the ability to associate a given end-of-word node with a particular value. In the example above, *all* words except `not` end at the exact same node, so how can we know where to look for the associated value(s) for those words?

Here's an example with `&notinvc;`:

<div style="text-align: center;">
<svg id="mermaid-dafsa" width="100%" xmlns="http://www.w3.org/2000/svg" class="mermaid-flowchart flowchart" style="max-width: 145.48333740234375px;" viewBox="0 0 145.48333740234375 500" role="graphics-document document" aria-roledescription="flowchart-v2"><g><marker id="mermaid-123_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M73.483,38.5L73.4,39.25C73.317,40,73.15,41.5,73.067,43.083C72.983,44.667,72.983,46.333,72.983,47.167L72.983,48" id="L_root_n_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,87L72.983,87.833C72.983,88.667,72.983,90.333,72.983,92C72.983,93.667,72.983,95.333,72.983,96.167L72.983,97" id="L_n_letter_o_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,136L72.983,136.833C72.983,137.667,72.983,139.333,72.983,141C72.983,142.667,72.983,144.333,72.983,145.167L72.983,146" id="L_letter_o_t_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M88.533,181.918L89.809,183.265C91.085,184.612,93.636,187.306,94.912,189.486C96.187,191.667,96.187,193.333,96.187,194.167L96.187,195" id="L_t_i1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M57.433,181.918L56.158,183.265C54.882,184.612,52.331,187.306,51.055,189.486C49.779,191.667,49.779,193.333,49.779,194.167L49.779,195" id="L_t_n1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,234L96.187,234.833C96.187,235.667,96.187,237.333,96.187,239C96.187,240.667,96.187,242.333,96.187,243.167L96.187,244" id="L_i1_n2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,234L49.779,234.833C49.779,235.667,49.779,237.333,49.779,239C49.779,240.667,49.779,242.333,49.779,243.167L49.779,244" id="L_n1_i2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,283L49.779,283.833C49.779,284.667,49.779,286.333,50.931,288.383C52.083,290.433,54.387,292.866,55.54,294.082L56.692,295.299" id="L_i2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,283L96.187,283.833C96.187,284.667,96.187,286.333,95.035,288.383C93.883,290.433,91.579,292.866,90.427,294.082L89.275,295.299" id="L_n2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M56.692,320.745L51.339,323.454C45.986,326.164,35.281,331.582,29.928,335.124C24.575,338.667,24.575,340.333,24.575,341.167L24.575,342" id="L_v_a_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,332L72.983,332.833C72.983,333.667,72.983,335.333,72.983,337C72.983,338.667,72.983,340.333,72.983,341.167L72.983,342" id="L_v_b_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M89.275,320.787L94.587,323.489C99.9,326.191,110.525,331.596,115.838,335.131C121.15,338.667,121.15,340.333,121.15,341.167L121.15,342" id="L_v_c_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M24.575,381L24.575,381.833C24.575,382.667,24.575,384.333,30.09,387.958C35.606,391.583,46.636,397.165,52.151,399.957L57.667,402.748" id="L_a_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,381L72.983,381.833C72.983,382.667,72.983,384.333,72.983,386C72.983,387.667,72.983,389.333,72.983,390.167L72.983,391" id="L_b_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.15,381L121.15,381.833C121.15,382.667,121.15,384.333,115.675,387.952C110.2,391.57,99.25,397.139,93.775,399.924L88.3,402.709" id="L_c_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,420L72.983,451" id="L_semi3_notinvc_0" class=" edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link unknown-value" style="" marker-end="url(#mermaid-123_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-root-0" transform="translate(72.98332977294922, 23)"><polygon points="15,0 30,-15 15,-30 0,-15" class="label-container" transform="translate(-15,15)"></polygon><g class="label" style="" transform="translate(0, 0)"><rect></rect><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-n-1" transform="translate(72.98332977294922, 67.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-letter_o-3" transform="translate(72.98332977294922, 116.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.666664123535156" y="-19.5" width="33.33332824707031" height="39"></rect><g class="label" style="" transform="translate(-4.291664123535156, -12)"><rect></rect><foreignObject width="8.583328247070312" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>o</p></span></div></foreignObject></g></g><g class="node default selected-path end-of-word" id="flowchart-t-5" transform="translate(72.98332977294922, 165.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.550003051757812" y="-19.5" width="31.100006103515625" height="39"></rect><g class="label" style="" transform="translate(-3.1750030517578125, -12)"><rect></rect><foreignObject width="6.350006103515625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>t</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-i1-7" transform="translate(49.7791633605957, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n1-8" transform="translate(96.18749618530273, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-n2-10" transform="translate(49.7791633605957, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>n</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i2-12" transform="translate(96.18749618530273, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-2.2833328247070312, -12)"><rect></rect><foreignObject width="4.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>i</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-v-14" transform="translate(72.98332977294922, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>v</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a-18" transform="translate(24.574996948242188, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>a</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b-19" transform="translate(72.98332977294922, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>b</p></span></div></foreignObject></g></g><g class="node default selected-path" id="flowchart-c-20" transform="translate(121.1500015258789, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>c</p></span></div></foreignObject></g></g><g class="node default selected-path end-of-word" id="flowchart-semi-22" transform="translate(72.98332977294922, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-2.9416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>;</p></span></div></foreignObject></g></g><g class="node default transformed-value unknown-value" id="flowchart-notinvc-42" transform="translate(72.983, 475.2249984741211)"><g class="basic label-container" style=""><circle class="outer-circle" style="" r="18.224998474121094" cx="0" cy="0"></circle><circle class="inner-circle" style="" r="13.224998474121094" cx="0" cy="0"></circle></g><g class="label" style="" transform="translate(-2.724998474121094, -12)"><rect></rect><foreignObject width="11.449996948242188" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>&nbsp;</p></span></div></foreignObject></g></g></g></g></g></svg>
</div>

We could use use a second data structure like a hash map to look up matching words after the fact, but that would mean sacrificing a lot of the data savings that we're using a DAFSA for in the first place. To give an idea of the amount of extra data involved, a hash map, at the absolute minimum (i.e. ignoring *all* overhead), would need to store the bytes of all possible named character references, which ends up being 16,641. The values would then take an additional 8,924 bytes.

With DAFSA nodes that are 4-byte aligned, the nodes themselves would require 15,488 bytes. So, with the DAFSA + a separate hash map, it'd need a minimum total of 41,053 bytes to store the data. Still less than the full trie, and there are probably ways to cut down the size further, i.e. using some sort of custom hashing scheme/minimal perfect hashing, but, luckily, we don't have to worry about that because it turns out it is possible to do...

### Minimal perfect hashing using a DAFSA

Within each node, store a count of all possible words from that node. For the example we've been using, those counts would look like this:

<div style="text-align: center;">
<svg id="mermaid-dafsa" width="100%" xmlns="http://www.w3.org/2000/svg" class="mermaid-flowchart flowchart" style="max-width: 145.48333740234375px;" viewBox="0 0 145.48333740234375 438" role="graphics-document document" aria-roledescription="flowchart-v2"><g><marker id="mermaid-123_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M73.483,38.5L73.4,39.25C73.317,40,73.15,41.5,73.067,43.083C72.983,44.667,72.983,46.333,72.983,47.167L72.983,48" id="L_root_n_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,87L72.983,87.833C72.983,88.667,72.983,90.333,72.983,92C72.983,93.667,72.983,95.333,72.983,96.167L72.983,97" id="L_n_letter_o_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,136L72.983,136.833C72.983,137.667,72.983,139.333,72.983,141C72.983,142.667,72.983,144.333,72.983,145.167L72.983,146" id="L_letter_o_t_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M88.533,181.918L89.809,183.265C91.085,184.612,93.636,187.306,94.912,189.486C96.187,191.667,96.187,193.333,96.187,194.167L96.187,195" id="L_t_i1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M57.433,181.918L56.158,183.265C54.882,184.612,52.331,187.306,51.055,189.486C49.779,191.667,49.779,193.333,49.779,194.167L49.779,195" id="L_t_n1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,234L96.187,234.833C96.187,235.667,96.187,237.333,96.187,239C96.187,240.667,96.187,242.333,96.187,243.167L96.187,244" id="L_i1_n2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,234L49.779,234.833C49.779,235.667,49.779,237.333,49.779,239C49.779,240.667,49.779,242.333,49.779,243.167L49.779,244" id="L_n1_i2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,283L49.779,283.833C49.779,284.667,49.779,286.333,50.931,288.383C52.083,290.433,54.387,292.866,55.54,294.082L56.692,295.299" id="L_i2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,283L96.187,283.833C96.187,284.667,96.187,286.333,95.035,288.383C93.883,290.433,91.579,292.866,90.427,294.082L89.275,295.299" id="L_n2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M56.692,320.745L51.339,323.454C45.986,326.164,35.281,331.582,29.928,335.124C24.575,338.667,24.575,340.333,24.575,341.167L24.575,342" id="L_v_a_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,332L72.983,332.833C72.983,333.667,72.983,335.333,72.983,337C72.983,338.667,72.983,340.333,72.983,341.167L72.983,342" id="L_v_b_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M89.275,320.787L94.587,323.489C99.9,326.191,110.525,331.596,115.838,335.131C121.15,338.667,121.15,340.333,121.15,341.167L121.15,342" id="L_v_c_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M24.575,381L24.575,381.833C24.575,382.667,24.575,384.333,30.09,387.958C35.606,391.583,46.636,397.165,52.151,399.957L57.667,402.748" id="L_a_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,381L72.983,381.833C72.983,382.667,72.983,384.333,72.983,386C72.983,387.667,72.983,389.333,72.983,390.167L72.983,391" id="L_b_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.15,381L121.15,381.833C121.15,382.667,121.15,384.333,115.675,387.952C110.2,391.57,99.25,397.139,93.775,399.924L88.3,402.709" id="L_c_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-root-0" transform="translate(72.98332977294922, 23)"><polygon points="15,0 30,-15 15,-30 0,-15" class="label-container" transform="translate(-15,15)"></polygon><g class="label" style="" transform="translate(0, 0)"><rect></rect><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "></span></div></foreignObject></g></g><g class="node default" id="flowchart-n-1" transform="translate(72.98332977294922, 67.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.775, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>7</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-letter_o-3" transform="translate(72.98332977294922, 116.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.666664123535156" y="-19.5" width="33.33332824707031" height="39"></rect><g class="label" style="" transform="translate(-4.291664123535156, -12)"><rect></rect><foreignObject width="8.583328247070312" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>7</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-t-5" transform="translate(72.98332977294922, 165.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.550003051757812" y="-19.5" width="31.100006103515625" height="39"></rect><g class="label" style="" transform="translate(-4.5750030517578125, -12)"><rect></rect><foreignObject width="9.350006103515625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>7</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-i1-7" transform="translate(49.7791633605957, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-3.2833328247070312, -12)"><rect></rect><foreignObject width="9.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n1-8" transform="translate(96.18749618530273, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-n2-10" transform="translate(49.7791633605957, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i2-12" transform="translate(96.18749618530273, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-4.2833328247070312, -12)"><rect></rect><foreignObject width="9.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-v-14" transform="translate(72.98332977294922, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a-18" transform="translate(24.574996948242188, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b-19" transform="translate(72.98332977294922, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-c-20" transform="translate(121.1500015258789, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi-22" transform="translate(72.98332977294922, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-3.5416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g></g></g></g></svg>
</div>

Then, to get a unique index for a given word, traverse the DAFSA as normal, but:

- For any node that is skipped over when searching a list of children, add their `number` to the unique index
- For nodes that match the current character, if the node is a valid end-of-word, add 1 to the unique index

This will produce a number between 1 and the total number of words in the DAFSA (inclusive), and it's guaranteed that each word will end up with a unique number.

Maybe TODO: Table of words on the left, highlight the current word. Table of unique index -> result on the right, highlight the current unique index.

<div style="text-align: center; position: relative;" id="dafsa-mph-container">
<div style="position: absolute; right: calc(50% + 35px + 80px); height: 100%;">
	<div style="position: absolute; top: 145px; right: 0px; padding: 5px;" id="row-4">+1</div>
	<div style="position: absolute; top: 195px; right: 0px; padding: 5px;" id="row-5">+3</div>
	<div style="position: absolute; top: 343px; right: 0px; padding: 5px;" id="row-8">+3</div>
	<div style="position: absolute; top: 395px; right: 0px; padding: 5px;" id="row-9">+1</div>
	<div style="position: absolute; top: 445px; right: 0px; padding: 5px; width: 30px; text-align: right; border-top: 1px solid;" class="unique-index-total">5</div>
</div>
<div style="background: #eee; width: 80px; position: absolute; left: calc(50% + 35px); bottom: calc(50% + 25px); padding: 5px;">
	<div>Unique<br/>index:</div>
	<div><b class="unique-index">0</b></div>
</div>
<svg id="mermaid-dafsa-mph" width="100%" xmlns="http://www.w3.org/2000/svg" class="mermaid-flowchart flowchart" style="max-width: 200px;" viewBox="0 0 200 500" role="graphics-document document" aria-roledescription="flowchart-v2"><g><marker id="mermaid-123_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></circle></marker><marker id="mermaid-123_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><marker id="mermaid-123_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2px; stroke-dasharray: 1px, 0px;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M73.483,38.5L73.4,39.25C73.317,40,73.15,41.5,73.067,43.083C72.983,44.667,72.983,46.333,72.983,47.167L72.983,48" id="L_root_n_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,87L72.983,87.833C72.983,88.667,72.983,90.333,72.983,92C72.983,93.667,72.983,95.333,72.983,96.167L72.983,97" id="L_n_letter_o_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,136L72.983,136.833C72.983,137.667,72.983,139.333,72.983,141C72.983,142.667,72.983,144.333,72.983,145.167L72.983,146" id="L_letter_o_t_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M88.533,181.918L89.809,183.265C91.085,184.612,93.636,187.306,94.912,189.486C96.187,191.667,96.187,193.333,96.187,194.167L96.187,195" id="L_t_i1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M57.433,181.918L56.158,183.265C54.882,184.612,52.331,187.306,51.055,189.486C49.779,191.667,49.779,193.333,49.779,194.167L49.779,195" id="L_t_n1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,234L96.187,234.833C96.187,235.667,96.187,237.333,96.187,239C96.187,240.667,96.187,242.333,96.187,243.167L96.187,244" id="L_i1_n2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,234L49.779,234.833C49.779,235.667,49.779,237.333,49.779,239C49.779,240.667,49.779,242.333,49.779,243.167L49.779,244" id="L_n1_i2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M49.779,283L49.779,283.833C49.779,284.667,49.779,286.333,50.931,288.383C52.083,290.433,54.387,292.866,55.54,294.082L56.692,295.299" id="L_i2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M96.187,283L96.187,283.833C96.187,284.667,96.187,286.333,95.035,288.383C93.883,290.433,91.579,292.866,90.427,294.082L89.275,295.299" id="L_n2_v_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M56.692,320.745L51.339,323.454C45.986,326.164,35.281,331.582,29.928,335.124C24.575,338.667,24.575,340.333,24.575,341.167L24.575,342" id="L_v_a_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,332L72.983,332.833C72.983,333.667,72.983,335.333,72.983,337C72.983,338.667,72.983,340.333,72.983,341.167L72.983,342" id="L_v_b_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M89.275,320.787L94.587,323.489C99.9,326.191,110.525,331.596,115.838,335.131C121.15,338.667,121.15,340.333,121.15,341.167L121.15,342" id="L_v_c_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M24.575,381L24.575,381.833C24.575,382.667,24.575,384.333,30.09,387.958C35.606,391.583,46.636,397.165,52.151,399.957L57.667,402.748" id="L_a_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M72.983,381L72.983,381.833C72.983,382.667,72.983,384.333,72.983,386C72.983,387.667,72.983,389.333,72.983,390.167L72.983,391" id="L_b_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M121.15,381L121.15,381.833C121.15,382.667,121.15,384.333,115.675,387.952C110.2,391.57,99.25,397.139,93.775,399.924L88.3,402.709" id="L_c_semi_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=""></path><path d="M180,220L180,251" id="L_semi3_notinvc_0" class=" edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-123_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml" class="labelBkg"><span class="edgeLabel "></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-root-0" transform="translate(72.98332977294922, 23)"><polygon points="15,0 30,-15 15,-30 0,-15" class="label-container" transform="translate(-15,15)"></polygon><g class="label" style="" transform="translate(0, 0)"><rect></rect><foreignObject width="0" height="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "></span></div></foreignObject></g></g><g class="node default" id="flowchart-n-1" transform="translate(72.98332977294922, 67.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.775, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>7</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-letter_o-3" transform="translate(72.98332977294922, 116.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.666664123535156" y="-19.5" width="33.33332824707031" height="39"></rect><g class="label" style="" transform="translate(-4.291664123535156, -12)"><rect></rect><foreignObject width="8.583328247070312" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>7</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-t-5" transform="translate(72.98332977294922, 165.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.550003051757812" y="-19.5" width="31.100006103515625" height="39"></rect><g class="label" style="" transform="translate(-4.5750030517578125, -12)"><rect></rect><foreignObject width="9.350006103515625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>7</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-i1-7" transform="translate(49.7791633605957, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-3.2833328247070312, -12)"><rect></rect><foreignObject width="9.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-n1-8" transform="translate(96.18749618530273, 214.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-n2-10" transform="translate(49.7791633605957, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.75" y="-19.5" width="33.5" height="39"></rect><g class="label" style="" transform="translate(-4.375, -12)"><rect></rect><foreignObject width="8.75" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-i2-12" transform="translate(96.18749618530273, 263.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-14.658332824707031" y="-19.5" width="29.316665649414062" height="39"></rect><g class="label" style="" transform="translate(-4.2833328247070312, -12)"><rect></rect><foreignObject width="9.5666656494140625" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-v-14" transform="translate(72.98332977294922, 312.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.291664123535156" y="-19.5" width="32.58332824707031" height="39"></rect><g class="label" style="" transform="translate(-3.9166641235351562, -12)"><rect></rect><foreignObject width="7.8333282470703125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>3</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-a-18" transform="translate(24.574996948242188, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.574996948242188" y="-19.5" width="33.149993896484375" height="39"></rect><g class="label" style="" transform="translate(-4.1999969482421875, -12)"><rect></rect><foreignObject width="8.399993896484375" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-b-19" transform="translate(72.98332977294922, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.833335876464844" y="-19.5" width="33.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-4.458335876464844, -12)"><rect></rect><foreignObject width="8.916671752929688" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-c-20" transform="translate(121.1500015258789, 361.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-16.333335876464844" y="-19.5" width="32.66667175292969" height="39"></rect><g class="label" style="" transform="translate(-3.9583358764648438, -12)"><rect></rect><foreignObject width="7.9166717529296875" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default end-of-word" id="flowchart-semi-22" transform="translate(72.98332977294922, 410.5)"><rect class="basic label-container" style="" rx="19.5" ry="19.5" x="-15.316665649414062" y="-19.5" width="30.633331298828125" height="39"></rect><g class="label" style="" transform="translate(-3.5416656494140625, -12)"><rect></rect><foreignObject width="5.883331298828125" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>1</p></span></div></foreignObject></g></g><g class="node default transformed-value" id="flowchart-notinvc-42" transform="translate(180, 275.2249984741211)"><g class="basic label-container" style=""><circle class="outer-circle" style="" r="18.224998474121094" cx="0" cy="0"></circle><circle class="inner-circle" style="" r="13.224998474121094" cx="0" cy="0"></circle></g><g class="label" style="" transform="translate(-5.724998474121094, -12)"><rect></rect><foreignObject width="11.449996948242188" height="24"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel "><p>??</p></span></div></foreignObject></g></g></g></g></g></svg>
</div>

<script>
(function(){
	let root = document.getElementById("dafsa-mph-container");
	let node_ids = [
		'flowchart-n-1',
		'flowchart-letter_o-3',
		'flowchart-t-5',
		'flowchart-i1-7',
		'flowchart-n1-8',
		'flowchart-n2-10',
		'flowchart-i2-12',
		'flowchart-v-14',
		'flowchart-a-18',
		'flowchart-b-19',
		'flowchart-c-20',
		'flowchart-semi-22'
	];
	let clear = function() {
		for (let i=0; i<node_ids.length; i++) {
			let e = root.querySelector('#'+node_ids[i]);
			e.classList.remove('selected-path');
			e.classList.remove('iterated-node');
			e.querySelector('.nodeLabel').style.display = 'none';
		}
	}
	let apply = function(word, unique_index) {
		for (let i=0; i<word.selected.length; i++) {
			let e = root.querySelector('#flowchart-'+word.selected[i]);
			e.classList.add('selected-path');
			let label = e.querySelector('.nodeLabel');
			label.textContent = word.word[i];
			label.style.display = 'block';
		}
		for (let i=0; i<word.iterated.length; i++) {
			let e = root.querySelector('#flowchart-'+word.iterated[i]);
			e.classList.add('iterated-node');
			let label = e.querySelector('.nodeLabel');
			label.textContent = word.numbers[i];
			label.style.display = 'block';
		}
		for (let i=0; i<word.ends.length; i++) {
			let e = root.querySelector('#flowchart-'+word.ends[i]);
			e.classList.add('iterated-node');
		}
		let row_lookup = [4,5,8,9];
		for (let i=0; i<row_lookup.length; i++) {
			let e = root.querySelector("#row-"+row_lookup[i]);
			e.textContent = word.rows[i] == 0 ? "" : "+"+word.rows[i];
		}
		root.querySelector('.transformed-value .nodeLabel').innerHTML = word.result;
		root.querySelector('.unique-index-total').textContent = unique_index;
		root.querySelector('.unique-index').textContent = unique_index;
	}
	let not = {
		selected: ['n-1', 'letter_o-3', 't-5'],
		word: 'not',
		iterated: [],
		numbers: [],
		ends: ['t-5'],
		rows: [1,0,0,0],
		result: '&not;'
	}
	let notinva = {
		selected: ['n-1', 'letter_o-3', 't-5', 'i1-7', 'n2-10', 'v-14', 'a-18', 'semi-22'],
		word: 'notinva;',
		iterated: [],
		numbers: [],
		ends: ['t-5', 'semi-22'],
		rows: [1,0,0,1],
		result: '&notinva;'
	}
	let notinvb = {
		selected: ['n-1', 'letter_o-3', 't-5', 'i1-7', 'n2-10', 'v-14', 'b-19', 'semi-22'],
		word: 'notinvb;',
		iterated: ['a-18'],
		numbers: [1],
		ends: ['t-5', 'semi-22'],
		rows: [1,0,1,1],
		result: '&notinvb;'
	}
	let notinvc = {
		selected: ['n-1', 'letter_o-3', 't-5', 'i1-7', 'n2-10', 'v-14', 'c-20', 'semi-22'],
		word: 'notinvc;',
		iterated: ['a-18', 'b-19'],
		numbers: [1, 1],
		ends: ['t-5', 'semi-22'],
		rows: [1,0,2,1],
		result: '&notinvc;'
	}
	let notniva = {
		selected: ['n-1', 'letter_o-3', 't-5', 'i2-12', 'n1-8', 'v-14', 'a-18', 'semi-22'],
		word: 'notniva;',
		iterated: ['i1-7'],
		numbers: [3],
		ends: ['t-5', 'semi-22'],
		rows: [1,3,0,1],
		result: '&notniva;'
	}
	let notnivb = {
		selected: ['n-1', 'letter_o-3', 't-5', 'i2-12', 'n1-8', 'v-14', 'b-19', 'semi-22'],
		word: 'notnivb;',
		iterated: ['i1-7', 'a-18'],
		numbers: [3, 1],
		ends: ['t-5', 'semi-22'],
		rows: [1,3,1,1],
		result: '&notnivb;'
	}
	let notnivc = {
		selected: ['n-1', 'letter_o-3', 't-5', 'i2-12', 'n1-8', 'v-14', 'c-20', 'semi-22'],
		word: 'notnivc;',
		iterated: ['i1-7', 'a-18', 'b-19'],
		numbers: [3, 1, 1],
		ends: ['t-5', 'semi-22'],
		rows: [1,3,2,1],
		result: '&notnivc;'
	}
	let sequence = [not, notinva, notinvb, notinvc, notniva, notnivb, notnivc];
	let cur_word_i = 0;
	clear();
	apply(sequence[cur_word_i], cur_word_i + 1);
	setInterval(function() {
		clear();
		cur_word_i = (cur_word_i + 1) % sequence.length;
		apply(sequence[cur_word_i], cur_word_i + 1);
	}, 2500);
})()
</script>

<p><aside class="note">

Note: It's not relevant here, but I think it's pretty cool that it's also possible to reconstruct the associated word if you have its unique index. You basically do the same thing as when you are calculating a unique index, but instead of adding to the unique index you're subtracting from it as you traverse the DAFSA. A tidbit that I accidentally ran into is that [this 'reverse lookup' only works if you include the end-of-word node itself in its own 'count of possible words from that node'](https://github.com/squeek502/named-character-references/commit/6619a3a8d1e86b1174269f73b413d957e56df975).

</aside></p>

3872 nodes

## The Ladybird implementation

> **13.2.5.73 Named character reference state**
>
> Consume the maximum number of characters possible, where the consumed characters are one of the identifiers in the first column of the named character references table. Append each character to the temporary buffer when it's consumed.
>
> - If there is a match
>     + ...
> 
> - Otherwise
>     + Flush code points consumed as a character reference. Switch to the ambiguous ampersand state.

```c
BEGIN_STATE(NamedCharacterReference)
{
    if (matcher.try_consume(current_character)) {
        temporary_buffer.append(current_character);
        continue; // stay in the NamedCharacterReference state and go to the next character
    } else {
        DONT_CONSUME_CHARACTER;
    }

    auto overconsumed_code_points = matcher.overconsumed_code_points();
    if (overconsumed_code_points > 0) {
        backtrack_to(current_offset - overconsumed_code_points);
        temporary_buffer.shrink_by(overconsumed_code_points);
    }

    auto mapped_codepoints = matcher.code_points();
    // If there is a match
    if (mapped_codepoints) {
        // ...
    } else {
        FLUSH_CODEPOINTS_CONSUMED_AS_A_CHARACTER_REFERENCE;
        SWITCH_TO(AmbiguousAmpersand);
    }
}
```

## Comparison to the major browser engines

Instead of going the route of putting my implementation into the other browsers' engines to compare, I went with taking the other browsers' implementations and putting them in Ladybird. So, you'll probably want to take the benchmarks in the following sections with a grain of salt, as in order for them to be accurate you'll have to trust that:

- I faithfully integrated the Gecko/Blink/WebKit implementations into Ladybird
- The performance characteristics exhibited would hold when putting my implementation into their tokenizer

The only real assurance I can give you is that the same number of [web platform tests](https://wpt.fyi/) within the `html/syntax/parsing` category were passing with each browser's implementation integrated.

### Comparison with Gecko (Firefox)

### Comparison with Blink/WebKit (Chrome/Safari)

Blink started as a fork of WebKit, and while Blink has reorganized things a bit, the named character reference tokenization implementation remains identical between the two engines.

---

size stuff

```
zig size: 15,488 + 5,857 = 21,345
ladybird size: 15,488 + (2,231 * 4) = 24,412

---

trie 1

{
	u12 for value index
	u1 for has_value
	u1 for has_children
	u14 for child index
}
4 * 9854 = 39,416
{
	u7 for char
	u1 for end of list
}
1 * 9853 = 9653
{
	u17 for first
	u4 for second
}
packed: (2231 * 21) / 8 + 1 = 5857
unpacked: 2231 * 4 = 8924

totals:
  packed: 39416 + 9653 + 5857 = 54,926
unpacked: 39416 + 9653 + 8924 = 57,993

---

trie 2

{
	u1 for has_children
	u1 for has_value
	u14 for child_index
}
2 * 9854 = 19,708
{
	u7 for char
	u1 for end of list
}
1 * 9853 = 9653
{
	u17 for first
	u4 for second
}
packed: (9854 * 21 + 1) / 8 = 25866
unpacked: 9854 * 4 = 39416

totals:
  packed: 19708 + 9653 + 25866 = 55,227
unpacked: 19708 + 9653 + 39416 = 68,777

---

blink
staticEntityStringStorage: 14,485 bytes
staticEntityTable: 2231 * 12 = 26,772 bytes
total: 41,257

diff to zig: 41,257 - 21,345 = 19,912
diff to ladybird: 16,845

---

https://chromium.googlesource.com/chromium/blink.git/+/refs/heads/main/Source/core/html/parser/create-html-entity-table
https://chromium.googlesource.com/chromium/blink.git/+/refs/heads/main/Source/wtf/text/WTFString.h
https://chromium.googlesource.com/chromium/blink.git/+/refs/heads/main/Source/core/html/parser/HTMLTokenizer.cpp
https://chromium.googlesource.com/chromium/blink.git/+/refs/heads/main/Source/core/html/parser/HTMLEntityTable.h

---

gecko
HILO_ACCEL[123] = 123 * 8 = 984
HILO_ACCEL_n[52]x44 = 44 * 52 * 4 = 9152
ALL_NAMES[12183]u8 = 12183
NAMES[2231] = 2231 * 4 = 8924
VALUES[2231] = 2231 * 4 = 8924
gecko total: 40,167

diff to zig: 40,167 - 21,345 = 18,822
diff to ladybird: 15,755

---

https://github.com/mozilla/gecko-dev/tree/master/parser/html
https://github.com/mozilla/gecko-dev/blob/master/parser/html/nsHtml5NamedCharactersInclude.h
https://github.com/mozilla/gecko-dev/blob/master/parser/html/nsHtml5NamedCharactersAccel.h
https://github.com/mozilla/gecko-dev/blob/master/parser/html/nsHtml5NamedCharactersAccel.cpp
https://github.com/mozilla/gecko-dev/blob/master/parser/html/nsHtml5NamedCharacters.h
https://github.com/mozilla/gecko-dev/blob/master/parser/html/nsHtml5NamedCharacters.cpp

---
```

<div>

<style scoped>
.mermaid-flowchart{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#ccc;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}.mermaid-flowchart .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}.mermaid-flowchart .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}.mermaid-flowchart .error-icon{fill:#a44141;}.mermaid-flowchart .error-text{fill:#ddd;stroke:#ddd;}.mermaid-flowchart .edge-thickness-normal{stroke-width:1px;}.mermaid-flowchart .edge-thickness-thick{stroke-width:3.5px;}.mermaid-flowchart .edge-pattern-solid{stroke-dasharray:0;}.mermaid-flowchart .edge-thickness-invisible{stroke-width:0;fill:none;}.mermaid-flowchart .edge-pattern-dashed{stroke-dasharray:3;}.mermaid-flowchart .edge-pattern-dotted{stroke-dasharray:2;}.mermaid-flowchart svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}.mermaid-flowchart p{margin:0;}.mermaid-flowchart .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#ccc;}.mermaid-flowchart .cluster-label text{fill:#F9FFFE;}.mermaid-flowchart .cluster-label span{color:#F9FFFE;}.mermaid-flowchart .cluster-label span p{background-color:transparent;}.mermaid-flowchart .rough-node .label text,.mermaid-flowchart .node .label text,.mermaid-flowchart .image-shape .label,.mermaid-flowchart .icon-shape .label{text-anchor:middle;}.mermaid-flowchart .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}.mermaid-flowchart .rough-node .label,.mermaid-flowchart .node .label,.mermaid-flowchart .image-shape .label,.mermaid-flowchart .icon-shape .label{text-align:center;}.mermaid-flowchart .node.clickable{cursor:pointer;}.mermaid-flowchart .edgeLabel{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}.mermaid-flowchart .edgeLabel p{background-color:hsl(0, 0%, 34.4117647059%);}.mermaid-flowchart .edgeLabel rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}.mermaid-flowchart .labelBkg{background-color:rgba(87.75, 87.75, 87.75, 0.5);}.mermaid-flowchart .cluster rect{fill:hsl(180, 1.5873015873%, 28.3529411765%);stroke:rgba(255, 255, 255, 0.25);stroke-width:1px;}.mermaid-flowchart .cluster text{fill:#F9FFFE;}.mermaid-flowchart .cluster span{color:#F9FFFE;}.mermaid-flowchart div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(20, 1.5873015873%, 12.3529411765%);border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}.mermaid-flowchart .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#ccc;}.mermaid-flowchart rect.text{fill:none;stroke-width:0;}.mermaid-flowchart .icon-shape,.mermaid-flowchart .image-shape{background-color:hsl(0, 0%, 34.4117647059%);text-align:center;}.mermaid-flowchart .icon-shape p,.mermaid-flowchart .image-shape p{background-color:hsl(0, 0%, 34.4117647059%);padding:2px;}.mermaid-flowchart .icon-shape rect,.mermaid-flowchart .image-shape rect{opacity:0.5;background-color:hsl(0, 0%, 34.4117647059%);fill:hsl(0, 0%, 34.4117647059%);}.mermaid-flowchart :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}

.mermaid-flowchart .marker{fill:#333;stroke:#333;}
.mermaid-flowchart .marker.cross{stroke:#333;}
.mermaid-flowchart .root .anchor path{fill:#333!important;stroke-width:0;stroke:#333;}
.mermaid-flowchart .arrowheadPath{fill:#333;}
.mermaid-flowchart .edgePath .path{stroke:#333;stroke-width:2.0px;}
.mermaid-flowchart .flowchart-link{stroke:#333;fill:none;}
.mermaid-flowchart .label text,.mermaid-flowchart span{fill:#333;color:#333;}
.mermaid-flowchart .node rect,.mermaid-flowchart .node circle,.mermaid-flowchart .node ellipse,.mermaid-flowchart .node polygon,.mermaid-flowchart .node path{fill:#DAE5E5;stroke:#333;stroke-width:1px;}
@media (prefers-color-scheme: dark) {
	.mermaid-flowchart .marker{fill:lightgrey;stroke:lightgrey;}
	.mermaid-flowchart .marker.cross{stroke:lightgrey;}
	.mermaid-flowchart .root .anchor path{fill:lightgrey!important;stroke-width:0;stroke:lightgrey;}
	.mermaid-flowchart .arrowheadPath{fill:lightgrey;}
	.mermaid-flowchart .edgePath .path{stroke:lightgrey;stroke-width:2.0px;}
	.mermaid-flowchart .flowchart-link{stroke:lightgrey;fill:none;}
	.mermaid-flowchart .label text,.mermaid-flowchart span{fill:#ccc;color:#ccc;}
	.mermaid-flowchart .node rect,.mermaid-flowchart .node circle,.mermaid-flowchart .node ellipse,.mermaid-flowchart .node polygon,.mermaid-flowchart .node path{fill:#1f2020;stroke:#ccc;stroke-width:1px;}
}

.mermaid-flowchart .node.transformed-value rect,
.mermaid-flowchart .node.transformed-value circle,
.mermaid-flowchart .node.transformed-value ellipse,
.mermaid-flowchart .node.transformed-value polygon,
.mermaid-flowchart .node.transformed-value path
{
  fill:#D4BFFF;stroke:#3B1B81;
}
@media (prefers-color-scheme: dark) {
	.mermaid-flowchart .node.transformed-value rect,
	.mermaid-flowchart .node.transformed-value circle,
	.mermaid-flowchart .node.transformed-value ellipse,
	.mermaid-flowchart .node.transformed-value polygon,
	.mermaid-flowchart .node.transformed-value path
	{
	  fill:#2F1743;stroke:#9570C5;
	}
}

.mermaid-flowchart .node.unknown-value rect,
.mermaid-flowchart .node.unknown-value circle,
.mermaid-flowchart .node.unknown-value ellipse,
.mermaid-flowchart .node.unknown-value polygon,
.mermaid-flowchart .node.unknown-value path
{
  stroke-dasharray: 5 5;
}
@media (prefers-color-scheme: dark) {
	.mermaid-flowchart .node.unknown-value rect,
	.mermaid-flowchart .node.unknown-value circle,
	.mermaid-flowchart .node.unknown-value ellipse,
	.mermaid-flowchart .node.unknown-value polygon,
	.mermaid-flowchart .node.unknown-value path
	{
	  fill:#2F1743;stroke:#9570C5;
	}
}

.mermaid-flowchart .unknown-value {
  animation: blinker 1s ease infinite;
}

@keyframes blinker {
  50% {
    opacity: 0.5;
  }
}

.mermaid-flowchart .node.selected-path rect,
.mermaid-flowchart .node.selected-path circle,
.mermaid-flowchart .node.selected-path ellipse,
.mermaid-flowchart .node.selected-path polygon,
.mermaid-flowchart .node.selected-path path
{
  fill:#FFE0BF;stroke:#814B1B;
}
@media (prefers-color-scheme: dark) {
	.mermaid-flowchart .node.selected-path rect,
	.mermaid-flowchart .node.selected-path circle,
	.mermaid-flowchart .node.selected-path ellipse,
	.mermaid-flowchart .node.selected-path polygon,
	.mermaid-flowchart .node.selected-path path
	{
	  fill:#433617;stroke:#C5A070;
	}
}

.mermaid-flowchart .node.iterated-node rect,
.mermaid-flowchart .node.iterated-node circle,
.mermaid-flowchart .node.iterated-node ellipse,
.mermaid-flowchart .node.iterated-node polygon,
.mermaid-flowchart .node.iterated-node path
{
  fill:#00E0BF;stroke:#004B1B;
}
@media (prefers-color-scheme: dark) {
	.mermaid-flowchart .node.iterated-node rect,
	.mermaid-flowchart .node.iterated-node circle,
	.mermaid-flowchart .node.iterated-node ellipse,
	.mermaid-flowchart .node.iterated-node polygon,
	.mermaid-flowchart .node.iterated-node path
	{
	  fill:#003617;stroke:#00A070;
	}
}

.mermaid-flowchart .node.end-of-word rect,
.mermaid-flowchart .node.end-of-word circle,
.mermaid-flowchart .node.end-of-word ellipse,
.mermaid-flowchart .node.end-of-word polygon,
.mermaid-flowchart .node.end-of-word path
{
  stroke:#811B1B; stroke-width: 2px;
}
@media (prefers-color-scheme: dark) {
	.mermaid-flowchart .node.end-of-word rect,
	.mermaid-flowchart .node.end-of-word circle,
	.mermaid-flowchart .node.end-of-word ellipse,
	.mermaid-flowchart .node.end-of-word polygon,
	.mermaid-flowchart .node.end-of-word path
	{
	  stroke:#C57070;
	}
}
</style>

</div>